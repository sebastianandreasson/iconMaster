{"version":3,"sources":["../../src/query/tabsequence.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAWA,MAAI,QAAQ,YAAA,CAAC;;AAEb,WAAS,sBAAsB,CAAC,QAAQ,EAAE,OAAO,EAAE;AACjD,QAAM,GAAG,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AACtC,QAAI,GAAG,GAAG,CAAC,EAAE;AACX,UAAM,GAAG,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;AACpC,aAAO,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;KAC7B;;AAED,WAAO,QAAQ,CAAC;GACjB;;AAED,WAAS,YAAY,CAAC,QAAQ,EAAE,QAAQ,EAAE;AACxC,YAAQ,GAAG,8BAAa,QAAQ,CAAC,CAAC;;AAElC,QAAI,QAAQ,CAAC,mCAAmC,EAAE;;;;AAIhD,cAAQ,GAAG,0BAAS,QAAQ,EAAE,QAAQ,CAAC,CAAC;KACzC;;AAED,WAAO,QAAQ,CAAC;GACjB;;mBAEc,YAAmD;qEAAJ,EAAE;;QAAvC,OAAO,QAAP,OAAO;QAAE,cAAc,QAAd,cAAc;QAAE,QAAQ,QAAR,QAAQ;;AACxD,QAAI,CAAC,QAAQ,EAAE;AACb,cAAQ,GAAG,4BAAW,CAAC;KACxB;;AAED,QAAM,QAAQ,GAAG,2BAAU,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,eAAe,CAAC;AACnE,QAAI,QAAQ,GAAG,+BAAc,EAAC,OAAO,EAAE,QAAQ,EAAE,cAAc,EAAd,cAAc,EAAE,QAAQ,EAAR,QAAQ,EAAC,CAAC,CAAC;;AAE5E,QAAI,QAAQ,CAAC,IAAI,CAAC,gBAAgB,KAAK,sBAAS,IAAI,KAAK,QAAQ,IAAI,sBAAS,IAAI,KAAK,eAAe,CAAA,AAAC,EAAE;;;AAGvG,cAAQ,GAAG,8BAAa,QAAQ,EAAE,QAAQ,EAAE,YAAY,CAAC,CAAC;KAC3D,MAAM;AACL,cAAQ,GAAG,YAAY,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;KAC7C;;AAED,QAAI,cAAc,EAAE;;;AAGlB,cAAQ,GAAG,sBAAsB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;KACvD;;AAED,WAAO,QAAQ,CAAC;GACjB","file":"tabsequence.js","sourcesContent":["\n// http://www.w3.org/TR/html5/editing.html#sequential-focus-navigation-and-the-tabindex-attribute\n// http://www.w3.org/WAI/PF/aria-practices/#keyboard\n\nimport platform from 'platform';\nimport queryTabbable from './tabbable';\nimport nodeArray from '../util/node-array';\nimport sortArea from './tabsequence.sort-area';\nimport sortShadowed from './tabsequence.sort-shadowed';\nimport sortTabindex from './tabsequence.sort-tabindex';\nimport _supports from './tabsequence.supports';\nlet supports;\n\nfunction moveContextToBeginning(elements, context) {\n  const pos = elements.indexOf(context);\n  if (pos > 0) {\n    const tmp = elements.splice(pos, 1);\n    return tmp.concat(elements);\n  }\n\n  return elements;\n}\n\nfunction sortElements(elements, _context) {\n  elements = sortTabindex(elements);\n\n  if (supports.tabsequenceSortsAreaAtImagePosition) {\n    // Some browsers sort <area> in DOM order, some place the <area>s\n    // where the <img> referecing them would've been in DOM order.\n    // https://github.com/medialize/ally.js/issues/5\n    elements = sortArea(elements, _context);\n  }\n\n  return elements;\n}\n\nexport default function({context, includeContext, strategy} = {}) {\n  if (!supports) {\n    supports = _supports();\n  }\n\n  const _context = nodeArray(context)[0] || document.documentElement;\n  let elements = queryTabbable({context: _context, includeContext, strategy});\n\n  if (document.body.createShadowRoot && (platform.name === 'Chrome' || platform.name === 'Chrome Mobile')) {\n    // sort tabindex localized to shadow dom\n    // see https://github.com/medialize/ally.js/issues/6\n    elements = sortShadowed(elements, _context, sortElements);\n  } else {\n    elements = sortElements(elements, _context);\n  }\n\n  if (includeContext) {\n    // if we include the context itself, it has to be the first\n    // element of the sequence\n    elements = moveContextToBeginning(elements, _context);\n  }\n\n  return elements;\n}\n"]}